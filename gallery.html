<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery - ShokherSrity</title>
    
    <!-- Performance optimization headers -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <meta http-equiv="Cache-Control" content="max-age=86400">
    
    <!-- PWA support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="attached_assets/logo.webp">
    
    <!-- Resource hints for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com">
    
    <!-- Preload critical assets -->
    <link rel="preload" href="style.css" as="style">
    <link rel="preload" href="attached_assets/logo.webp" as="image" type="image/webp">
    <link rel="preload" href="attached_assets/1.webp" as="image" type="image/webp" fetchpriority="high">
    
    <!-- DNS prefetch -->
    <link rel="dns-prefetch" href="https://www.facebook.com">
    <link rel="dns-prefetch" href="https://www.instagram.com">
    
    <!-- Meta tags for SEO and performance -->
    <meta name="description" content="ShokherSrity Photography Gallery - View our wedding photography portfolio">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Stylesheet loading optimization -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" media="print" onload="this.media='all'">
    <link rel="icon" href="attached_assets/logo.webp" type="image/webp">
    
    <!-- Inline critical CSS for faster rendering -->
    <style>
        /* Critical CSS for above-the-fold content */
        body {margin:0;padding:0;font-family:'Montserrat',sans-serif}
        header {position:fixed;width:100%;z-index:1000;backdrop-filter:blur(10px);background:rgba(0,0,0,.85)}
        .logo {color:transparent;background:linear-gradient(45deg,#ffd700,#ffed4a);-webkit-background-clip:text;background-clip:text}
        nav ul {display:flex;list-style:none;justify-content:center;flex-wrap:wrap;gap:1.5rem}
        nav ul li a {color:white;text-decoration:none;padding:.5rem 1rem;font-weight:600}
        
        /* Reduce motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
    </style>
    
    <!-- Preload AOS script -->
    <link rel="preload" href="https://unpkg.com/aos@2.3.1/dist/aos.js" as="script">
</head>
<body>
    <script>
        // Remove any existing service workers (disable offline mode)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    registration.unregister();
                    console.log('Service Worker unregistered');
                }
            });
        }
    </script>
    
    <header>
        <nav>
            <div class="logo">ShokherSrity</div>
            <button class="mobile-menu-btn">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="packages.html">Packages</a></li>
                <li><a href="download.html">App</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="gallery-main">
        <h1>Our Portfolio</h1>
        <div class="gallery-grid">
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/1.webp" alt="Wedding Photo 1" loading="lazy" width="800" height="600" fetchpriority="high">
                <div class="image-caption">Wedding Moment</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/2.webp" alt="Wedding Photo 2" loading="lazy" width="800" height="600">
                <div class="image-caption">Celebration of Love</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/3.webp" alt="Wedding Photo 3" loading="lazy" width="800" height="600">
                <div class="image-caption">Perfect Couple</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/4.webp" alt="Wedding Photo 4" loading="lazy" width="800" height="600">
                <div class="image-caption">Special Moments</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/5.webp" alt="Wedding Photo 5" loading="lazy" width="800" height="600">
                <div class="image-caption">Forever Together</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/6.webp" alt="Wedding Photo 6" loading="lazy" width="800" height="600">
                <div class="image-caption">Beautiful Bride</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/7.webp" alt="Wedding Photo 7" loading="lazy" width="800" height="600">
                <div class="image-caption">Wedding Ceremony</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/8.webp" alt="Wedding Photo 8" loading="lazy" width="800" height="600">
                <div class="image-caption">Romantic Moment</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/9.webp" alt="Wedding Photo 9" loading="lazy" width="800" height="600">
                <div class="image-caption">Family Celebration</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/10.webp" alt="Wedding Photo 10" loading="lazy" width="800" height="600">
                <div class="image-caption">Traditional Ceremony</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/11.webp" alt="Wedding Photo 11" loading="lazy" width="800" height="600">
                <div class="image-caption">Joyful Dance</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/12.webp" alt="Wedding Photo 12" loading="lazy" width="800" height="600">
                <div class="image-caption">Wedding Portraits</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/13.webp" alt="Wedding Photo 13" loading="lazy" width="800" height="600">
                <div class="image-caption">Moments of Joy</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/14.webp" alt="Wedding Photo 14" loading="lazy" width="800" height="600">
                <div class="image-caption">Wedding Details</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/15.webp" alt="Wedding Photo 15" loading="lazy" width="800" height="600">
                <div class="image-caption">First Dance</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/16.webp" alt="Wedding Photo 16" loading="lazy" width="800" height="600">
                <div class="image-caption">Wedding Bliss</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/17.webp" alt="Wedding Photo 17" loading="lazy" width="800" height="600">
                <div class="image-caption">Couple Portrait</div>
            </div>
            <div class="gallery-item portrait" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/18.webp" alt="Wedding Photo 18" loading="lazy" width="800" height="600">
                <div class="image-caption">Magical Evening</div>
            </div>
            <div class="gallery-item landscape" data-aos="fade-up">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600' %3E%3C/svg%3E" data-src="attached_assets/19.webp" alt="Wedding Photo 19" loading="lazy" width="800" height="600">
                <div class="image-caption">Reception Highlights</div>
            </div>
        </div>
        <div class="view-more-container">
            <a href="https://www.facebook.com/shokhersrity" target="_blank" class="view-more-button">View More</a>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>Contact Us</h3>
                <p>Email: shokhersrity@gmail.com</p>
                <p>Kowsik Saha: +880 1799334656</p>
                <p>Dip Pal: +880 1700504456</p>
            </div>
            <div class="footer-section">
                <h3>Follow Us</h3>
                <div class="social-links">
                    <a href="https://www.instagram.com/shokhersrity?igsh=YzRwbmVieHppeW14" target="_blank">Instagram</a>
                    <a href="https://www.facebook.com/shokhersrity" target="_blank">Facebook</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; ShokherSrity. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="script.js"></script>
    
    <!-- Lightbox -->
    <div class="lightbox">
        <div class="lightbox-content">
            <img src="" alt="" class="lightbox-img">
            <div class="lightbox-caption"></div>
        </div>
        <div class="lightbox-close">&times;</div>
        <div class="lightbox-nav">
            <div class="lightbox-prev">&#10094;</div>
            <div class="lightbox-next">&#10095;</div>
        </div>
    </div>

    <script>        
        // Defer non-critical JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            // Performance optimization: Use requestIdleCallback for non-critical tasks
            const initGallery = () => {
                // Load AOS with optimized settings
                AOS.init({
                    duration: 800,
                    easing: 'ease-out',
                    once: true, // Changed to true for better performance
                    offset: 100,
                    delay: 100,
                    disable: 'mobile' // Disable on mobile for better performance
                });
                
                // Image optimization
                optimizeImages();
                
                // Initialize lightbox
                initLightbox();
            };
            
            // Use requestIdleCallback if available, fall back to setTimeout
            if ('requestIdleCallback' in window) {
                requestIdleCallback(initGallery, { timeout: 2000 });
            } else {
                setTimeout(initGallery, 200);
            }
            
            // Image optimization function
            function optimizeImages() {
                const images = document.querySelectorAll('.gallery-item img');
                
                // Create IntersectionObserver for efficient lazy loading
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            
                            // Load image
                            if (img.dataset.src) {
                                img.src = img.dataset.src;
                                img.removeAttribute('data-src');
                            }
                            
                            // Add loaded class for animation
                            img.classList.add('loaded');
                            
                            // Stop observing once loaded
                            observer.unobserve(img);
                            
                            // Log performance metrics
                            if (window.performance) {
                                const perfData = window.performance.getEntriesByName(img.src);
                                if (perfData.length) {
                                    console.log(`Image loaded: ${img.alt} - ${Math.round(perfData[0].duration)}ms`);
                                }
                            }
                        }
                    });
                }, {
                    rootMargin: '100px 0px', // Increased rootMargin for earlier loading
                    threshold: 0.1
                });
                
                // Optimize image loading order
                // First load images in the current viewport
                images.forEach(img => {
                    // Check if in viewport
                    const rect = img.getBoundingClientRect();
                    const isInViewport = (
                        rect.top >= 0 &&
                        rect.left >= 0 &&
                        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                    );
                    
                    if (isInViewport) {
                        // Set high priority for viewport images
                        img.fetchPriority = 'high';
                    }
                    
                    // Start observing
                    imageObserver.observe(img);
                });
            }
            
            // Lightbox functionality - optimized version
            function initLightbox() {
                const lightbox = document.querySelector('.lightbox');
                const lightboxImg = document.querySelector('.lightbox-img');
                const lightboxCaption = document.querySelector('.lightbox-caption');
                const lightboxClose = document.querySelector('.lightbox-close');
                const lightboxPrev = document.querySelector('.lightbox-prev');
                const lightboxNext = document.querySelector('.lightbox-next');
                
                const galleryItems = document.querySelectorAll('.gallery-item');
                let currentIndex = 0;
                
                // Performance optimization: Use event delegation instead of multiple listeners
                document.querySelector('.gallery-grid').addEventListener('click', function(e) {
                    // Find the gallery item that was clicked
                    const item = e.target.closest('.gallery-item');
                    if (!item) return;
                    
                    // Get the index of the clicked item
                    currentIndex = Array.from(galleryItems).indexOf(item);
                    
                    // Update and show lightbox
                    updateLightbox();
                    lightbox.classList.add('active');
                    
                    // Prevent body scrolling with less layout thrashing
                    document.body.style.overflow = 'hidden';
                    document.body.style.paddingRight = '15px';
                    document.body.style.position = 'fixed';
                    document.body.style.width = '100%';
                    
                    // Preload next and previous images for smoother navigation
                    preloadAdjacentImages(currentIndex);
                });
                
                // Close lightbox - use one function for all close events
                function closeLightbox() {
                    lightbox.classList.remove('active');
                    
                    // Re-enable body scrolling
                    document.body.style.overflow = '';
                    document.body.style.paddingRight = '';
                    document.body.style.position = '';
                    document.body.style.width = '';
                }
                
                // Close on button click
                lightboxClose.addEventListener('click', closeLightbox);
                
                // Close on outside click - optimized event handler
                lightbox.addEventListener('click', function(e) {
                    if (e.target === lightbox) {
                        closeLightbox();
                    }
                });
                
                // Navigate to previous image with debounce to prevent rapid clicking
                let navTimeout;
                lightboxPrev.addEventListener('click', function() {
                    if (navTimeout) return;
                    navTimeout = setTimeout(() => {
                        currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
                        updateLightbox();
                        preloadAdjacentImages(currentIndex);
                        navTimeout = null;
                    }, 200);
                });
                
                // Navigate to next image with debounce
                lightboxNext.addEventListener('click', function() {
                    if (navTimeout) return;
                    navTimeout = setTimeout(() => {
                        currentIndex = (currentIndex + 1) % galleryItems.length;
                        updateLightbox();
                        preloadAdjacentImages(currentIndex);
                        navTimeout = null;
                    }, 200);
                });
                
                // Update lightbox content - optimized
                function updateLightbox() {
                    const currentItem = galleryItems[currentIndex];
                    const imgSrc = currentItem.querySelector('img').src;
                    const caption = currentItem.querySelector('.image-caption')?.textContent || '';
                    
                    // Performance optimization: Only update DOM if content has changed
                    if (lightboxImg.src !== imgSrc) {
                        lightboxImg.src = imgSrc;
                    }
                    
                    if (lightboxCaption.textContent !== caption) {
                        lightboxCaption.textContent = caption;
                    }
                }
                
                // Preload adjacent images for smoother navigation
                function preloadAdjacentImages(index) {
                    const nextIndex = (index + 1) % galleryItems.length;
                    const prevIndex = (index - 1 + galleryItems.length) % galleryItems.length;
                    
                    // Preload next and previous images
                    const nextImg = galleryItems[nextIndex].querySelector('img').src;
                    const prevImg = galleryItems[prevIndex].querySelector('img').src;
                    
                    // Create Image objects to preload them
                    new Image().src = nextImg;
                    new Image().src = prevImg;
                }
                
                // Keyboard navigation - optimized
                document.addEventListener('keydown', function(e) {
                    if (!lightbox.classList.contains('active')) return;
                    
                    switch (e.key) {
                        case 'Escape':
                            closeLightbox();
                            break;
                        case 'ArrowLeft':
                            if (!navTimeout) {
                                navTimeout = setTimeout(() => {
                                    currentIndex = (currentIndex - 1 + galleryItems.length) % galleryItems.length;
                                    updateLightbox();
                                    preloadAdjacentImages(currentIndex);
                                    navTimeout = null;
                                }, 200);
                            }
                            break;
                        case 'ArrowRight':
                            if (!navTimeout) {
                                navTimeout = setTimeout(() => {
                                    currentIndex = (currentIndex + 1) % galleryItems.length;
                                    updateLightbox();
                                    preloadAdjacentImages(currentIndex);
                                    navTimeout = null;
                                }, 200);
                            }
                            break;
                    }
                });
            }
        });
        
        // Add passive event listeners for better scroll performance
        document.addEventListener('touchstart', function() {}, {passive: true});
        document.addEventListener('touchmove', function() {}, {passive: true});
        
        // Detect slow connections and adjust quality
        if (navigator.connection) {
            const connection = navigator.connection;
            if (connection.effectiveType === '2g' || connection.saveData) {
                // Reduce animations for slow connections
                document.documentElement.classList.add('reduce-motion');
            }
        }
    </script>
</body>
</html>
